<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>OCHO</title>
</head>

<body style="font-family:Arial; text-align:center; padding:30px">
  <h2>ğŸ OCHO ğŸ‘½</h2>

  <p id="info" style="font-size:16px; opacity:.85"></p>

  <audio id="player" controls preload="auto" style="width:min(520px,95vw)"></audio>
  <br><br>

  <button id="btn" style="font-size:18px; padding:12px 18px; cursor:pointer;">
    â–¶ï¸ Ascolta
  </button>

  <button id="altro" style="font-size:18px; padding:12px 18px; cursor:pointer; margin-left:10px;">
    ğŸ” Un altro
  </button>

  <script>
    // ========= CONFIG =========
    const TOTAL = 123;    // <-- METTI QUI IL NUMERO TOTALE DEI TUOI MP3
    const FOLDER = "mp3"; // cartella dove hai caricato gli mp3 nel repo

    // Se i file si chiamano esattamente come questo pattern:
    // 001_Chapter 0.mp3, 002_Chapter 0.mp3, ... 123_Chapter 0.mp3
    const SUFFIX = "_Chapter 0.mp3";  // <-- se cambia, dimmelo

    // ========= LOGIC =========
    const player = document.getElementById("player");
    const info = document.getElementById("info");

    function pad3(n) {
      return String(n).padStart(3, "0");
    }

    function pickRandom() {
      const n = Math.floor(Math.random() * TOTAL) + 1; // 1..TOTAL
      const filename = `${pad3(n)}${SUFFIX}`;           // es. 007_Chapter 0.mp3
      const url = `${FOLDER}/${encodeURIComponent(filename)}`;
      return { n, filename, url };
    }

    function loadRandom() {
      const { n, filename, url } = pickRandom();
      player.src = url;
      player.load();
      info.textContent = `Traccia casuale: ${filename}  (${n}/${TOTAL})`;
    }

    // Carica una traccia casuale appena apri la pagina
    loadRandom();

    document.getElementById("btn").addEventListener("click", async () => {
      try {
        await player.play(); // su iPhone serve click: questo Ã¨ perfetto
      } catch (e) {
        alert("Se non parte, premi Play nel player audio (alcuni telefoni bloccano l'avvio automatico).");
      }
    });

    document.getElementById("altro").addEventListener("click", async () => {
      loadRandom();
      try { await player.play(); } catch (e) {}
    });
  </script>
</body>
</html>
